{"ast":null,"code":"import _classCallCheck from\"/Users/peiwendu/Desktop/shuoshuo2.0/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/peiwendu/Desktop/shuoshuo2.0/client/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/peiwendu/Desktop/shuoshuo2.0/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/peiwendu/Desktop/shuoshuo2.0/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/peiwendu/Desktop/shuoshuo2.0/client/node_modules/@babel/runtime/helpers/esm/inherits\";import React from'react';import Axios from'axios';import CommentPanel from'../components/CommentPanel';import Loader from'react-loader-spinner';import{connect}from'react-redux';import{withRouter}from'react-router-dom';import{url}from'../url';import{Icon}from'antd';import'antd/dist/antd.css';import Img from'../components/Img';import CommentList from'../components/CommentList';var PostDetail=/*#__PURE__*/function(_React$Component){_inherits(PostDetail,_React$Component);function PostDetail(){var _getPrototypeOf2;var _this;_classCallCheck(this,PostDetail);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(PostDetail)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={post:[],comment_number:'',like_number:0,loading:false,like:false};_this.handleLike=function(){if(_this.props.auth.user){Axios.get(url+'/dolike?pid='+_this.props.match.params.pid+'&user='+_this.props.auth.user).then(function(res){console.log(res.data.result);_this.setState({like:true,like_number:_this.state.like?_this.state.like_number:_this.state.like_number+1});}).catch(function(err){return console.log(err);});}else{_this.props.history.push('/signin');}};return _this;}_createClass(PostDetail,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;this.setState({loading:true},function(){Axios.get(url+'/getpostwithid?pid='+_this2.props.match.params.pid).then(function(res){_this2.setState({post:res.data.result,comment_number:res.data.comment_number,like_number:res.data.like_number,loading:false});}).then(function(){_this2.state.post.map(function(post){if(post.likes&&post.likes.indexOf(_this2.props.auth.user)>=0){_this2.setState({like:true});}});});});}},{key:\"render\",value:function render(){var _this3=this;console.log(this.state);return React.createElement(\"div\",{className:\"post-container\"},this.state.loading?React.createElement(Loader,{type:\"ThreeDots\",style:{\"display\":\"flex\",\"justifyContent\":\"center\"},color:\"#e87110\",height:\"100\",width:\"100\"}):React.createElement(React.Fragment,null,React.createElement(\"div\",{className:\"list-group\"},this.state.post.map(function(item,index){return React.createElement(\"a\",{className:\"list-group-item\",style:{paddingBottom:'0px'},key:index},React.createElement(\"div\",{style:{\"display\":\"flex\",\"flexDirection\":\"row\"}},React.createElement(\"div\",{className:\"comment-avatar\"},React.createElement(Img,{src:url+\"/avatar/\"+item.username+'.jpg',alt:\"\"})),React.createElement(\"div\",{className:\"username\"},React.createElement(\"h4\",null,item.username),React.createElement(\"p\",null,\" Published at \",item.datetime))),React.createElement(\"div\",{className:\"content\",style:{\"padding-bottom\":\"10px\"}},React.createElement(\"p\",null,item.content)),React.createElement(CommentPanel,{isShown:true,pid:_this3.props.match.params.pid}),React.createElement(\"div\",{className:\"comment-like\"},React.createElement(\"div\",{className:\"comment-tab\"},React.createElement(Icon,{type:\"message\",theme:\"outlined\",style:{fontSize:'18px',color:'ddd'}}),React.createElement(\"span\",{style:{\"fontSize\":\"16px\"}},\" \",_this3.state.comment_number)),React.createElement(\"div\",{className:\"like-tab\",onClick:_this3.handleLike},_this3.state.like?React.createElement(Icon,{type:\"like\",theme:\"filled\",style:{fontSize:'18px',color:'#ffc73b'}}):React.createElement(Icon,{type:\"like\",theme:\"outlined\",style:{fontSize:'18px',color:'ddd'}}),React.createElement(\"span\",{style:{\"fontSize\":\"16px\"}},\" \",_this3.state.like_number))));})),React.createElement(CommentList,{post:this.state.post})));}}]);return PostDetail;}(React.Component);var mapStateToProps=function mapStateToProps(state){return{auth:state.auth};};export default withRouter(connect(mapStateToProps,null)(PostDetail));","map":{"version":3,"sources":["/Users/peiwendu/Desktop/shuoshuo2.0/client/src/pages/PostDetail.js"],"names":["React","Axios","CommentPanel","Loader","connect","withRouter","url","Icon","Img","CommentList","PostDetail","state","post","comment_number","like_number","loading","like","handleLike","props","auth","user","get","match","params","pid","then","res","console","log","data","result","setState","catch","err","history","push","map","likes","indexOf","item","index","paddingBottom","username","datetime","content","fontSize","color","Component","mapStateToProps"],"mappings":"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","sourcesContent":["import React from 'react'\nimport Axios from 'axios';\nimport CommentPanel from '../components/CommentPanel'\nimport Loader from 'react-loader-spinner'\nimport { connect } from 'react-redux'\nimport { withRouter } from 'react-router-dom'\nimport { url } from '../url'\nimport { Icon } from 'antd';\nimport 'antd/dist/antd.css'\nimport Img from '../components/Img'\nimport CommentList from '../components/CommentList'\n\n\nclass PostDetail extends  React.Component {\n\n    state = {\n       post: [],\n       comment_number: '',\n       like_number: 0,\n       loading: false,\n       like: false\n    }\n    \n    componentDidMount(){\n        this.setState({loading: true}, () => {   \n            Axios.get(url + '/getpostwithid?pid=' + this.props.match.params.pid).then(res => {\n                this.setState({\n                    post: res.data.result,\n                    comment_number: res.data.comment_number,\n                    like_number: res.data.like_number,\n                    loading: false,\n                })\n            }).then(() => {\n                this.state.post.map(post => {\n                   if (post.likes && post.likes.indexOf(this.props.auth.user)>= 0){\n                       this.setState({\n                           like: true\n                       })\n                   }\n                })\n            })\n           \n        })   \n    }\n\n    handleLike = () => {\n        if(this.props.auth.user){\n            Axios.get(url + '/dolike?pid=' + this.props.match.params.pid + '&user=' + this.props.auth.user)\n                .then (res => {\n                    console.log(res.data.result)\n                    this.setState({\n                        like: true,\n                        like_number: this.state.like? this.state.like_number : this.state.like_number + 1\n                    })\n                }).catch(err => console.log(err))\n        } else {\n            this.props.history.push('/signin')\n        }\n        \n    }    \n    render(){\n\n         console.log(this.state)\n        return ( \n            <div className=\"post-container\">\n            {\n                this.state.loading? \n                <Loader type=\"ThreeDots\" \n                    style={{\"display\": \"flex\", \"justifyContent\": \"center\"}} \n                    color=\"#e87110\" \n                    height=\"100\" \n                    width=\"100\" />\n                :\n                <React.Fragment>\n                    <div className=\"list-group\">\n                    {\n                      this.state.post.map((item, index) => {\n                       return (       \n                        <a className=\"list-group-item\" style={{paddingBottom: '0px'}} key={index}>\n                            <div style={{\"display\": \"flex\", \"flexDirection\": \"row\"}}>\n                                <div className=\"comment-avatar\">\n                                    <Img src={url + \"/avatar/\" + item.username + '.jpg'} alt=\"\"/>\n                                </div>\n                                 <div className=\"username\">\n                                    <h4>{item.username}</h4> \n                                    <p> Published at {item.datetime}</p>\n                                </div>\n                             </div>\n                            <div className=\"content\" style={{\"padding-bottom\": \"10px\"}}>\n                                <p>{item.content}</p>\n                            </div>    \n                            <CommentPanel isShown={true} pid={this.props.match.params.pid}/>\n                            <div className=\"comment-like\">\n                            <div className=\"comment-tab\">\n                                <Icon type=\"message\" \n                                    theme=\"outlined\" \n                                    style={{ fontSize: '18px', color: 'ddd' }}/>\n                                <span style={{\"fontSize\": \"16px\"}}> {this.state.comment_number}</span>\n                             </div>\n                            <div className=\"like-tab\" onClick={this.handleLike}>\n                                {\n                                    this.state.like? \n                                    <Icon type=\"like\" \n                                        theme=\"filled\" \n                                        style={{ fontSize: '18px', color: '#ffc73b' }}/>\n                                    :\n                                    <Icon type=\"like\" \n                                    theme=\"outlined\" \n                                    style={{ fontSize: '18px', color: 'ddd' }}/>\n                                }\n                               \n                                    <span style={{\"fontSize\": \"16px\"}}> {this.state.like_number}</span>\n                                </div>\n                            </div>             \n                        </a> \n                       )\n                   })\n                }\n                </div>\n                <CommentList post={this.state.post} />\n            </React.Fragment>\n            }\n           </div>\n\n        )\n    }\n}\n\nconst mapStateToProps = (state) => {\n    return {\n        auth: state.auth\n    }\n}\n\n\nexport default withRouter(connect(mapStateToProps, null)(PostDetail))"]},"metadata":{},"sourceType":"module"}