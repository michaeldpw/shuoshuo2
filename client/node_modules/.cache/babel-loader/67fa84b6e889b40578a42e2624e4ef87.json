{"ast":null,"code":"import _regeneratorRuntime from\"/Users/peiwendu/Desktop/shuoshuo2.0/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/peiwendu/Desktop/shuoshuo2.0/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/peiwendu/Desktop/shuoshuo2.0/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/peiwendu/Desktop/shuoshuo2.0/client/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/peiwendu/Desktop/shuoshuo2.0/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/peiwendu/Desktop/shuoshuo2.0/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/peiwendu/Desktop/shuoshuo2.0/client/node_modules/@babel/runtime/helpers/esm/inherits\";import React from'react';import axios from'axios';import'./components.css';import Img from'./Img';import{url}from'../url';import Loader from'react-loader-spinner';import{Icon}from'antd';import'antd/dist/antd.css';var PostList=/*#__PURE__*/function(_React$Component){_inherits(PostList,_React$Component);function PostList(){var _getPrototypeOf2;var _this;_classCallCheck(this,PostList);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(PostList)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={post:[],total:0,currentPage:1,loading:false};_this.getCount=function(){axios.get(url+'/count').then(function(res){_this.setState({total:res.data.count});});};_this.getData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(page){var response,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"\".concat(url,\"/allpost?page=\").concat(page),{method:'GET',headers:{'Accept':'application/json','Content-Type':'application/json'}});case 2:response=_context.sent;_context.next=5;return response.json();case 5:data=_context.sent;_this.setState({post:data.result,currentPage:data.page+1,loading:false});case 7:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();_this.handlePrevious=function(){if(_this.state.currentPage!==1){_this.getData(_this.state.currentPage-1-1);console.log(\"previous\");}};_this.handleNext=function(){var total_page=Math.ceil(_this.state.total/5);console.log(_this.state.currentPage+1);if(_this.state.currentPage<total_page){_this.getData(_this.state.currentPage);console.log(\"next\");}};return _this;}_createClass(PostList,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;this.setState({loading:true},function(){_this2.getCount();_this2.getData(0);});//0是后端的第一页\n}},{key:\"render\",value:function render(){var _this3=this;var pageNumber=[];if(this.state.total!==0){for(var i=1;i<=Math.ceil(this.state.total/5);i++){pageNumber.push(i);}}return React.createElement(\"div\",{className:\"container\"},React.createElement(\"nav\",{id:\"pagination-nav\",\"aria-label\":\"Page navigation\"},React.createElement(\"ul\",{className:\"pagination\"},React.createElement(\"li\",{onClick:this.handlePrevious},React.createElement(\"a\",{\"aria-label\":\"Previous\"},React.createElement(\"span\",{\"aria-hidden\":\"true\"},\"\\xAB\"))),pageNumber.map(function(item,index){var classes=_this3.state.currentPage===item?\"active\":'';return React.createElement(\"li\",{key:index,className:classes},React.createElement(\"a\",{onClick:function onClick(){return _this3.getData(item-1);}},item));}),React.createElement(\"li\",{onClick:this.handleNext},React.createElement(\"a\",{\"aria-label\":\"Next\"},React.createElement(\"span\",{\"aria-hidden\":\"true\"},\"\\xBB\"))))),this.state.loading?React.createElement(Loader,{type:\"ThreeDots\",style:{\"display\":\"flex\",\"justifyContent\":\"center\"},color:\"#e87110\",height:\"100\",width:\"100\"}):React.createElement(\"div\",{className:\"list-group\"},this.state.post.map(function(item,index){return React.createElement(\"a\",{className:\"list-group-item\",key:index},React.createElement(\"div\",{style:{\"display\":\"flex\",\"flex-direction\":\"row\"}},React.createElement(\"div\",{className:\"comment-avatar\"},React.createElement(Img,{src:url+\"/avatar/\"+item.username+'.jpg',alt:\"\"})),React.createElement(\"div\",{className:\"username\"},React.createElement(\"h4\",null,item.username),React.createElement(\"p\",null,item.datetime))),React.createElement(\"div\",{className:\"content\"},React.createElement(\"p\",null,item.content)),React.createElement(\"div\",{className:\"comment-like\"},React.createElement(\"div\",{className:\"comment-tab\"},React.createElement(Icon,{type:\"message\",theme:\"outlined\",style:{fontSize:'18px',color:'ddd'}}),React.createElement(\"span\",{style:{\"fontSize\":\"16px\"}},\" Comment\")),React.createElement(\"div\",{className:\"like-tab\"},React.createElement(Icon,{type:\"like\",theme:\"outlined\",style:{fontSize:'18px',color:'ddd'}}),React.createElement(\"span\",{style:{\"fontSize\":\"16px\"}},\" Like\"))));})));}}]);return PostList;}(React.Component);export default PostList;","map":{"version":3,"sources":["/Users/peiwendu/Desktop/shuoshuo2.0/client/src/components/PostList.js"],"names":["React","axios","Img","url","Loader","Icon","PostList","state","post","total","currentPage","loading","getCount","get","then","res","setState","data","count","getData","page","fetch","method","headers","response","json","result","handlePrevious","console","log","handleNext","total_page","Math","ceil","pageNumber","i","push","map","item","index","classes","username","datetime","content","fontSize","color","Component"],"mappings":"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","sourcesContent":["import React from 'react'\nimport axios from 'axios';\nimport './components.css';\nimport Img from './Img';\nimport { url } from '../url'\nimport Loader from 'react-loader-spinner'\nimport { Icon } from 'antd';\nimport 'antd/dist/antd.css'\n\nclass PostList extends React.Component{\n\n    state = {\n        post: [],\n        total: 0,\n        currentPage: 1,\n        loading: false\n    }\n\n    getCount = () => {\n        axios.get(url + '/count').then(res => {\n            this.setState({\n                total: res.data.count\n            })\n        })\n    }\n\n    getData = async (page) => {\n        const response = await fetch(`${url}/allpost?page=${page}`, {\n            method: 'GET',\n            headers: {\n              'Accept': 'application/json',\n              'Content-Type': 'application/json',\n            },\n          });\n      \n          const data = await response.json();\n      \n          this.setState({\n            post: data.result,\n            currentPage: data.page + 1,\n            loading: false\n          });\n    }\n\n    componentDidMount(){\n        this.setState({loading: true}, () => {\n            this.getCount();\n            this.getData(0);\n        })\n         //0是后端的第一页\n        \n    }\n\n    handlePrevious = () => {\n\n        if(this.state.currentPage !== 1){\n            this.getData(this.state.currentPage - 1 - 1);\n            console.log(\"previous\");\n        }\n    }\n\n    handleNext = () => {\n        var total_page = Math.ceil(this.state.total/5);\n        console.log(this.state.currentPage + 1 );\n        if(this.state.currentPage < total_page){\n            this.getData(this.state.currentPage);\n            console.log(\"next\");\n        }\n    }\n\n    render(){\n\n        const pageNumber = [];\n        if(this.state.total !== 0){\n            for(let i = 1; i <= Math.ceil(this.state.total/5); i++){\n                pageNumber.push(i);\n            }\n        }\n\n        return (\n            <div className=\"container\">\n               <nav id=\"pagination-nav\" aria-label=\"Page navigation\">\n                    <ul className=\"pagination\">\n                        <li onClick={this.handlePrevious}>\n                            <a aria-label=\"Previous\">\n                                <span aria-hidden=\"true\" >&laquo;</span>\n                            </a>\n                        </li>\n                            {\n                               pageNumber.map((item, index) => {\n                                let classes = (this.state.currentPage) === item ? \"active\" : '';\n                                        return <li key={index} className={classes}>\n                                                    <a \n                                                       onClick={() => this.getData(item - 1)}    \n                                                    >\n                                                       {item}\n                                                    </a>\n\n                                                </li>                         \n                               })\n                            }\n                        <li onClick={this.handleNext}>\n                            <a  aria-label=\"Next\" >\n                                <span aria-hidden=\"true\">&raquo;</span>\n                            </a>\n                        </li>\n                    </ul>\n                </nav>\n\n                {\n                  this.state.loading? \n                  <Loader type=\"ThreeDots\" \n                          style={{\"display\": \"flex\", \"justifyContent\": \"center\"}} \n                          color=\"#e87110\" \n                          height=\"100\" \n                          width=\"100\" \n                  />\n                  :\n                \n               <div className=\"list-group\">\n                    {\n                        this.state.post.map((item, index) => {\n                            return (\n                                 <a className=\"list-group-item\" key={index}>\n                                     <div style={{\"display\": \"flex\", \"flex-direction\": \"row\"}}>\n                                    <div className=\"comment-avatar\">\n                                           <Img src={url + \"/avatar/\" + item.username + '.jpg'} alt=\"\"/>\n                                    </div>\n                                    <div className=\"username\">\n                                        <h4>{item.username}</h4> \n                                        <p>{item.datetime}</p>\n                                    </div>\n                                    </div>\n                                    <div className=\"content\">\n                                        <p>{item.content}</p>\n                                    </div>\n                                    <div className=\"comment-like\">\n                                        <div className=\"comment-tab\">\n                                            <Icon type=\"message\" \n                                                theme=\"outlined\" \n                                                style={{ fontSize: '18px', color: 'ddd' }}/>\n                                            <span style={{\"fontSize\": \"16px\"}}> Comment</span>\n                                        </div>\n                                        <div className=\"like-tab\">\n                                            <Icon type=\"like\" \n                                                    theme=\"outlined\" \n                                                    style={{ fontSize: '18px', color: 'ddd' }}/>\n                                                <span style={{\"fontSize\": \"16px\"}}> Like</span>\n                                            </div>\n                                    </div>\n                                   \n                                   \n                                </a>\n                            )\n                        })\n                    }\n                </div>\n                }\n            </div> \n            \n        )\n    }\n\n\n\n}\n\nexport default PostList"]},"metadata":{},"sourceType":"module"}