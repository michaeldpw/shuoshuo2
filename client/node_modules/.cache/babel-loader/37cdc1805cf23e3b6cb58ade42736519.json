{"ast":null,"code":"import _regeneratorRuntime from\"/Users/peiwendu/Desktop/shuoshuo2.0/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/peiwendu/Desktop/shuoshuo2.0/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/peiwendu/Desktop/shuoshuo2.0/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/peiwendu/Desktop/shuoshuo2.0/client/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/peiwendu/Desktop/shuoshuo2.0/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/peiwendu/Desktop/shuoshuo2.0/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/peiwendu/Desktop/shuoshuo2.0/client/node_modules/@babel/runtime/helpers/esm/inherits\";import React from'react';import axios from'axios';import'./components.css';import{url}from'../url';import{NavLink}from'react-router-dom';import PostListItem from'./PostListItem';import Loader from'react-loader-spinner';var PostList=/*#__PURE__*/function(_React$Component){_inherits(PostList,_React$Component);function PostList(){var _getPrototypeOf2;var _this;_classCallCheck(this,PostList);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(PostList)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={post:[],total:0,currentPage:1,loading:false,openComment:false};_this.getCount=function(){axios.get(url+'/count').then(function(res){_this.setState({total:res.data.count});});};_this.getData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(page){var response,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"\".concat(url,\"/allpost?page=\").concat(page),{method:'GET',headers:{'Accept':'application/json','Content-Type':'application/json'}});case 2:response=_context.sent;_context.next=5;return response.json();case 5:data=_context.sent;_this.setState({post:data.result,currentPage:data.page+1,loading:false});case 7:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();_this.handlePrevious=function(){if(_this.state.currentPage!==1){_this.getData(_this.state.currentPage-1-1);console.log(\"previous\");}};_this.handleNext=function(){var total_page=Math.ceil(_this.state.total/5);console.log(_this.state.currentPage+1);if(_this.state.currentPage<total_page){_this.getData(_this.state.currentPage);console.log(\"next\");}};_this.handleShowComment=function(){_this.setState({openComment:!_this.state.openComment});};return _this;}_createClass(PostList,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;this.setState({loading:true},function(){_this2.getCount();_this2.getData(0);});//0是后端的第一页\n}},{key:\"render\",value:function render(){var _this3=this;var pageNumber=[];if(this.state.total!==0){for(var i=1;i<=Math.ceil(this.state.total/5);i++){pageNumber.push(i);}}return React.createElement(\"div\",{className:\"container\"},this.state.loading?React.createElement(Loader,{type:\"ThreeDots\",style:{\"display\":\"flex\",\"justifyContent\":\"center\"},color:\"#e87110\",height:\"100\",width:\"100\"}):React.createElement(React.Fragment,null,React.createElement(\"nav\",{id:\"pagination-nav\",\"aria-label\":\"Page navigation\"},React.createElement(\"ul\",{className:\"pagination\"},React.createElement(\"li\",{onClick:this.handlePrevious},React.createElement(\"a\",{\"aria-label\":\"Previous\"},React.createElement(\"span\",{\"aria-hidden\":\"true\"},\"\\xAB\"))),pageNumber.map(function(item,index){var classes=_this3.state.currentPage===item?\"active\":'';return React.createElement(\"li\",{key:index,className:classes},React.createElement(\"a\",{onClick:function onClick(){return _this3.getData(item-1);}},item));}),React.createElement(\"li\",{onClick:this.handleNext},React.createElement(\"a\",{\"aria-label\":\"Next\"},React.createElement(\"span\",{\"aria-hidden\":\"true\"},\"\\xBB\"))))),React.createElement(\"div\",{className:\"list-group\"},this.state.post.map(function(item,index){var comments_number=item.comments?item.comments.length:0;return React.createElement(PostListItem,{item:item,comments_number:comments_number,id:item._id,index:index});}))));}}]);return PostList;}(React.Component);export default PostList;","map":{"version":3,"sources":["/Users/peiwendu/Desktop/shuoshuo2.0/client/src/components/PostList.js"],"names":["React","axios","url","NavLink","PostListItem","Loader","PostList","state","post","total","currentPage","loading","openComment","getCount","get","then","res","setState","data","count","getData","page","fetch","method","headers","response","json","result","handlePrevious","console","log","handleNext","total_page","Math","ceil","handleShowComment","pageNumber","i","push","map","item","index","classes","comments_number","comments","length","_id","Component"],"mappings":"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","sourcesContent":["import React from 'react'\nimport axios from 'axios';\nimport './components.css';\nimport { url } from '../url'\nimport { NavLink } from 'react-router-dom'\nimport PostListItem from './PostListItem'\nimport Loader from 'react-loader-spinner'\n\n\nclass PostList extends React.Component{\n\n    state = {\n        post: [],\n        total: 0,\n        currentPage: 1,\n        loading: false,\n        openComment: false\n    }\n\n    getCount = () => {\n        axios.get(url + '/count').then(res => {\n            this.setState({\n                total: res.data.count\n            })\n        })\n    }\n\n    getData = async (page) => {\n        const response = await fetch(`${url}/allpost?page=${page}`, {\n            method: 'GET',\n            headers: {\n              'Accept': 'application/json',\n              'Content-Type': 'application/json',\n            },\n          });\n      \n          const data = await response.json();\n      \n          this.setState({\n            post: data.result,\n            currentPage: data.page + 1,\n            loading: false\n          });\n    }\n\n    componentDidMount(){\n        this.setState({loading: true}, () => {\n            this.getCount();\n            this.getData(0);\n        })\n         //0是后端的第一页\n        \n    }\n\n    handlePrevious = () => {\n\n        if(this.state.currentPage !== 1){\n            this.getData(this.state.currentPage - 1 - 1);\n            console.log(\"previous\");\n        }\n    }\n\n    handleNext = () => {\n        var total_page = Math.ceil(this.state.total/5);\n        console.log(this.state.currentPage + 1 );\n        if(this.state.currentPage < total_page){\n            this.getData(this.state.currentPage);\n            console.log(\"next\");\n        }\n    }\n\n    handleShowComment = () => {\n        this.setState({\n            openComment: !this.state.openComment\n        })\n    }\n\n    render(){\n\n        const pageNumber = [];\n        if(this.state.total !== 0){\n            for(let i = 1; i <= Math.ceil(this.state.total/5); i++){\n                pageNumber.push(i);\n            }\n        }\n\n        return (\n            <div className=\"container\">\n\n                {\n                  this.state.loading? \n                  <Loader type=\"ThreeDots\" \n                          style={{\"display\": \"flex\", \"justifyContent\": \"center\"}} \n                          color=\"#e87110\" \n                          height=\"100\" \n                          width=\"100\" \n                  />\n                  :\n                  <React.Fragment>\n                  <nav id=\"pagination-nav\" aria-label=\"Page navigation\">\n                  <ul className=\"pagination\">\n                      <li onClick={this.handlePrevious}>\n                          <a aria-label=\"Previous\">\n                              <span aria-hidden=\"true\" >&laquo;</span>\n                          </a>\n                      </li>\n                          {\n                             pageNumber.map((item, index) => {\n                              let classes = (this.state.currentPage) === item ? \"active\" : '';\n                                      return <li key={index} className={classes}>\n                                                  <a \n                                                     onClick={() => this.getData(item - 1)}    \n                                                  >\n                                                     {item}\n                                                  </a>\n\n                                              </li>                         \n                             })\n                          }\n                      <li onClick={this.handleNext}>\n                          <a  aria-label=\"Next\" >\n                              <span aria-hidden=\"true\">&raquo;</span>\n                          </a>\n                      </li>\n                  </ul>\n              </nav>\n                  <div className=\"list-group\">\n                    {\n                        this.state.post.map((item, index) => {\n                            \n                            var comments_number = item.comments? item.comments.length: 0\n                            \n                            return (  \n                                <PostListItem item={item}  \n                                                comments_number={comments_number} \n                                                id={item._id} \n                                                index={index}/>       \n                            )\n                        })\n                    }\n                  </div>\n                </React.Fragment>\n                }\n            </div> \n            \n            \n        )\n    }\n\n\n\n}\n\nexport default PostList"]},"metadata":{},"sourceType":"module"}