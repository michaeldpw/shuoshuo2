{"ast":null,"code":"var _jsxFileName = \"/Users/peiwendu/Desktop/shuoshuo2.0/client/src/components/PostList.js\";\nimport React from 'react';\nimport axios from 'axios';\nimport './components.css';\nimport Img from './Img';\nimport { url } from '../url';\nimport Loader from 'react-loader-spinner';\n\nclass PostList extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      post: [],\n      total: 0,\n      currentPage: 1,\n      loading: false\n    };\n\n    this.getCount = () => {\n      axios.get(url + '/count').then(res => {\n        this.setState({\n          total: res.data.count\n        });\n      });\n    };\n\n    this.getData = async page => {\n      const response = await fetch(\"\".concat(url, \"/allpost?page=\").concat(page), {\n        method: 'GET',\n        headers: {\n          'Accept': 'application/json',\n          'Content-Type': 'application/json'\n        }\n      });\n      const data = await response.json();\n      this.setState({\n        post: data.result,\n        currentPage: data.page + 1\n      });\n    };\n\n    this.handlePrevious = () => {\n      if (this.state.currentPage !== 1) {\n        this.getData(this.state.currentPage - 1 - 1);\n        console.log(\"previous\");\n      }\n    };\n\n    this.handleNext = () => {\n      var total_page = Math.ceil(this.state.total / 5);\n      console.log(this.state.currentPage + 1);\n\n      if (this.state.currentPage < total_page) {\n        this.getData(this.state.currentPage);\n        console.log(\"next\");\n      }\n    };\n  }\n\n  componentDidMount() {\n    this.getCount();\n    this.getData(0); //0是后端的第一页\n\n    console.log(process.env.NODE_ENV);\n  }\n\n  render() {\n    const pageNumber = [];\n\n    if (this.state.total !== 0) {\n      for (let i = 1; i <= Math.ceil(this.state.total / 5); i++) {\n        pageNumber.push(i);\n      }\n    }\n\n    return React.createElement(\"div\", {\n      className: \"container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75\n      },\n      __self: this\n    }, React.createElement(\"nav\", {\n      \"aria-label\": \"Page navigation\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76\n      },\n      __self: this\n    }, React.createElement(\"ul\", {\n      className: \"pagination\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77\n      },\n      __self: this\n    }, React.createElement(\"li\", {\n      onClick: this.handlePrevious,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78\n      },\n      __self: this\n    }, React.createElement(\"a\", {\n      \"aria-label\": \"Previous\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      \"aria-hidden\": \"true\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80\n      },\n      __self: this\n    }, \"\\xAB\"))), pageNumber.map((item, index) => {\n      let classes = this.state.currentPage === item ? \"active\" : '';\n      return React.createElement(\"li\", {\n        key: index,\n        className: classes,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86\n        },\n        __self: this\n      }, React.createElement(\"a\", {\n        onClick: () => this.getData(item - 1),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87\n        },\n        __self: this\n      }, item));\n    }), React.createElement(\"li\", {\n      onClick: this.handleNext,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96\n      },\n      __self: this\n    }, React.createElement(\"a\", {\n      \"aria-label\": \"Next\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      \"aria-hidden\": \"true\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    }, \"\\xBB\"))))), React.createElement(\"div\", {\n      className: \"list-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103\n      },\n      __self: this\n    }, this.state.post.map((item, index) => {\n      return React.createElement(\"a\", {\n        className: \"list-group-item\",\n        key: index,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"comment-avatar\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108\n        },\n        __self: this\n      }, React.createElement(Img, {\n        src: url + \"/avatar/\" + item.username + '.jpg',\n        alt: \"\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"username\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111\n        },\n        __self: this\n      }, React.createElement(\"h4\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112\n        },\n        __self: this\n      }, item.username), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113\n        },\n        __self: this\n      }, item.datetime)), React.createElement(\"div\", {\n        className: \"content\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116\n        },\n        __self: this\n      }, item.content)));\n    })));\n  }\n\n}\n\nexport default PostList;","map":{"version":3,"sources":["/Users/peiwendu/Desktop/shuoshuo2.0/client/src/components/PostList.js"],"names":["React","axios","Img","url","Loader","PostList","Component","state","post","total","currentPage","loading","getCount","get","then","res","setState","data","count","getData","page","response","fetch","method","headers","json","result","handlePrevious","console","log","handleNext","total_page","Math","ceil","componentDidMount","process","env","NODE_ENV","render","pageNumber","i","push","map","item","index","classes","username","datetime","content"],"mappings":"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","sourcesContent":["import React from 'react'\nimport axios from 'axios';\nimport './components.css';\nimport Img from './Img';\nimport { url } from '../url'\nimport Loader from 'react-loader-spinner'\n\nclass PostList extends React.Component{\n\n    state = {\n        post: [],\n        total: 0,\n        currentPage: 1,\n        loading: false\n    }\n\n    getCount = () => {\n        axios.get(url + '/count').then(res => {\n            this.setState({\n                total: res.data.count\n            })\n        })\n    }\n\n    getData = async (page) => {\n        const response = await fetch(`${url}/allpost?page=${page}`, {\n            method: 'GET',\n            headers: {\n              'Accept': 'application/json',\n              'Content-Type': 'application/json',\n            },\n          });\n      \n          const data = await response.json();\n      \n          this.setState({\n            post: data.result,\n            currentPage: data.page + 1\n          });\n    }\n\n    componentDidMount(){\n        this.getCount();\n        this.getData(0); //0是后端的第一页\n        console.log(process.env.NODE_ENV)\n    }\n\n    handlePrevious = () => {\n\n        if(this.state.currentPage !== 1){\n            this.getData(this.state.currentPage - 1 - 1);\n            console.log(\"previous\");\n        }\n    }\n\n    handleNext = () => {\n        var total_page = Math.ceil(this.state.total/5);\n        console.log(this.state.currentPage + 1 );\n        if(this.state.currentPage < total_page){\n            this.getData(this.state.currentPage);\n            console.log(\"next\");\n        }\n    }\n\n    render(){\n\n        const pageNumber = [];\n        if(this.state.total !== 0){\n            for(let i = 1; i <= Math.ceil(this.state.total/5); i++){\n                pageNumber.push(i);\n            }\n        }\n\n        return (\n            <div className=\"container\">\n               <nav aria-label=\"Page navigation\">\n                    <ul className=\"pagination\">\n                        <li onClick={this.handlePrevious}>\n                            <a aria-label=\"Previous\">\n                                <span aria-hidden=\"true\" >&laquo;</span>\n                            </a>\n                        </li>\n                            {\n                               pageNumber.map((item, index) => {\n                                let classes = (this.state.currentPage) === item ? \"active\" : '';\n                                        return <li key={index} className={classes}>\n                                                    <a \n                                                       onClick={() => this.getData(item - 1)}    \n                                                    >\n                                                       {item}\n                                                    </a>\n\n                                                </li>                         \n                               })\n                            }\n                        <li onClick={this.handleNext}>\n                            <a  aria-label=\"Next\" >\n                                <span aria-hidden=\"true\">&raquo;</span>\n                            </a>\n                        </li>\n                    </ul>\n                </nav>\n               <div className=\"list-group\">\n                    {\n                        this.state.post.map((item, index) => {\n                            return (\n                                 <a className=\"list-group-item\" key={index}>\n                                    <div className=\"comment-avatar\">\n                                           <Img src={url + \"/avatar/\" + item.username + '.jpg'} alt=\"\"/>\n                                    </div>\n                                    <div className=\"username\">\n                                        <h4>{item.username}</h4> \n                                        <p>{item.datetime}</p>\n                                    </div>\n                                    <div className=\"content\">\n                                        <p>{item.content}</p>\n                                    </div>\n                                   \n                                   \n                                </a>\n                            )\n                        })\n                    }\n                </div>\n            </div> \n            \n        )\n    }\n\n\n\n}\n\nexport default PostList"]},"metadata":{},"sourceType":"module"}