{"ast":null,"code":"var _jsxFileName = \"/Users/peiwendu/Desktop/shuoshuo2.0/client/src/components/PostList.js\";\nimport React from 'react';\nimport axios from 'axios';\nimport './components.css';\nimport { url } from '../url';\nimport { NavLink } from 'react-router-dom';\nimport PostListItem from './PostListItem';\nimport Loader from 'react-loader-spinner';\n\nclass PostList extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      post: [],\n      total: 0,\n      currentPage: 1,\n      loading: false,\n      openComment: false\n    };\n\n    this.getCount = () => {\n      axios.get(url + '/count').then(res => {\n        this.setState({\n          total: res.data.count\n        });\n      });\n    };\n\n    this.getData = async page => {\n      const response = await fetch(\"\".concat(url, \"/allpost?page=\").concat(page), {\n        method: 'GET',\n        headers: {\n          'Accept': 'application/json',\n          'Content-Type': 'application/json'\n        }\n      });\n      const data = await response.json();\n      this.setState({\n        post: data.result,\n        currentPage: data.page + 1,\n        loading: false\n      });\n    };\n\n    this.handlePrevious = () => {\n      if (this.state.currentPage !== 1) {\n        this.getData(this.state.currentPage - 1 - 1);\n        console.log(\"previous\");\n      }\n    };\n\n    this.handleNext = () => {\n      var total_page = Math.ceil(this.state.total / 5);\n      console.log(this.state.currentPage + 1);\n\n      if (this.state.currentPage < total_page) {\n        this.getData(this.state.currentPage);\n        console.log(\"next\");\n      }\n    };\n\n    this.handleShowComment = () => {\n      this.setState({\n        openComment: !this.state.openComment\n      });\n    };\n  }\n\n  componentDidMount() {\n    this.setState({\n      loading: true\n    }, () => {\n      this.getCount();\n      this.getData(0);\n    }); //0是后端的第一页\n  }\n\n  render() {\n    const pageNumber = [];\n\n    if (this.state.total !== 0) {\n      for (let i = 1; i <= Math.ceil(this.state.total / 5); i++) {\n        pageNumber.push(i);\n      }\n    }\n\n    return React.createElement(\"div\", {\n      className: \"container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88\n      },\n      __self: this\n    }, this.state.loading ? React.createElement(Loader, {\n      type: \"ThreeDots\",\n      style: {\n        \"display\": \"flex\",\n        \"justifyContent\": \"center\"\n      },\n      color: \"#e87110\",\n      height: \"100\",\n      width: \"100\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92\n      },\n      __self: this\n    }) : React.createElement(React.Fragment, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    }, React.createElement(\"nav\", {\n      id: \"pagination-nav\",\n      \"aria-label\": \"Page navigation\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    }, React.createElement(\"ul\", {\n      className: \"pagination\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101\n      },\n      __self: this\n    }, React.createElement(\"li\", {\n      onClick: this.handlePrevious,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102\n      },\n      __self: this\n    }, React.createElement(\"a\", {\n      \"aria-label\": \"Previous\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      \"aria-hidden\": \"true\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104\n      },\n      __self: this\n    }, \"\\xAB\"))), pageNumber.map((item, index) => {\n      let classes = this.state.currentPage === item ? \"active\" : '';\n      return React.createElement(\"li\", {\n        key: index,\n        className: classes,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110\n        },\n        __self: this\n      }, React.createElement(\"a\", {\n        onClick: () => this.getData(item - 1),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111\n        },\n        __self: this\n      }, item));\n    }), React.createElement(\"li\", {\n      onClick: this.handleNext,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120\n      },\n      __self: this\n    }, React.createElement(\"a\", {\n      \"aria-label\": \"Next\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      \"aria-hidden\": \"true\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122\n      },\n      __self: this\n    }, \"\\xBB\"))))), React.createElement(\"div\", {\n      className: \"list-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }, this.state.post.map((item, index) => {\n      var comments_number = item.comments ? item.comments.length : 0;\n      var likes_number = item.likes ? item.likes.length : 0;\n      return React.createElement(PostListItem, {\n        item: item,\n        comments_number: comments_number,\n        like_number: likes_number,\n        id: item._id,\n        index: index,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135\n        },\n        __self: this\n      });\n    }))));\n  }\n\n}\n\nexport default PostList;","map":{"version":3,"sources":["/Users/peiwendu/Desktop/shuoshuo2.0/client/src/components/PostList.js"],"names":["React","axios","url","NavLink","PostListItem","Loader","PostList","Component","state","post","total","currentPage","loading","openComment","getCount","get","then","res","setState","data","count","getData","page","response","fetch","method","headers","json","result","handlePrevious","console","log","handleNext","total_page","Math","ceil","handleShowComment","componentDidMount","render","pageNumber","i","push","map","item","index","classes","comments_number","comments","length","likes_number","likes","_id"],"mappings":"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","sourcesContent":["import React from 'react'\nimport axios from 'axios';\nimport './components.css';\nimport { url } from '../url'\nimport { NavLink } from 'react-router-dom'\nimport PostListItem from './PostListItem'\nimport Loader from 'react-loader-spinner'\n\n\nclass PostList extends React.Component{\n\n    state = {\n        post: [],\n        total: 0,\n        currentPage: 1,\n        loading: false,\n        openComment: false\n    }\n\n    getCount = () => {\n        axios.get(url + '/count').then(res => {\n            this.setState({\n                total: res.data.count\n            })\n        })\n    }\n\n    getData = async (page) => {\n        const response = await fetch(`${url}/allpost?page=${page}`, {\n            method: 'GET',\n            headers: {\n              'Accept': 'application/json',\n              'Content-Type': 'application/json',\n            },\n          });\n      \n          const data = await response.json();\n      \n          this.setState({\n            post: data.result,\n            currentPage: data.page + 1,\n            loading: false\n          });\n    }\n\n    componentDidMount(){\n        this.setState({loading: true}, () => {\n            this.getCount();\n            this.getData(0);\n        })\n         //0是后端的第一页\n        \n    }\n\n    handlePrevious = () => {\n\n        if(this.state.currentPage !== 1){\n            this.getData(this.state.currentPage - 1 - 1);\n            console.log(\"previous\");\n        }\n    }\n\n    handleNext = () => {\n        var total_page = Math.ceil(this.state.total/5);\n        console.log(this.state.currentPage + 1 );\n        if(this.state.currentPage < total_page){\n            this.getData(this.state.currentPage);\n            console.log(\"next\");\n        }\n    }\n\n    handleShowComment = () => {\n        this.setState({\n            openComment: !this.state.openComment\n        })\n    }\n\n    render(){\n\n        const pageNumber = [];\n        if(this.state.total !== 0){\n            for(let i = 1; i <= Math.ceil(this.state.total/5); i++){\n                pageNumber.push(i);\n            }\n        }\n\n        return (\n            <div className=\"container\">\n\n                {\n                  this.state.loading? \n                  <Loader type=\"ThreeDots\" \n                          style={{\"display\": \"flex\", \"justifyContent\": \"center\"}} \n                          color=\"#e87110\" \n                          height=\"100\" \n                          width=\"100\" \n                  />\n                  :\n                  <React.Fragment>\n                  <nav id=\"pagination-nav\" aria-label=\"Page navigation\">\n                  <ul className=\"pagination\">\n                      <li onClick={this.handlePrevious}>\n                          <a aria-label=\"Previous\">\n                              <span aria-hidden=\"true\" >&laquo;</span>\n                          </a>\n                      </li>\n                          {\n                             pageNumber.map((item, index) => {\n                              let classes = (this.state.currentPage) === item ? \"active\" : '';\n                                      return <li key={index} className={classes}>\n                                                  <a \n                                                     onClick={() => this.getData(item - 1)}    \n                                                  >\n                                                     {item}\n                                                  </a>\n\n                                              </li>                         \n                             })\n                          }\n                      <li onClick={this.handleNext}>\n                          <a  aria-label=\"Next\" >\n                              <span aria-hidden=\"true\">&raquo;</span>\n                          </a>\n                      </li>\n                  </ul>\n              </nav>\n                  <div className=\"list-group\">\n                    {\n                        this.state.post.map((item, index) => {\n                            \n                            var comments_number = item.comments? item.comments.length: 0;\n                            var likes_number = item.likes? item.likes.length: 0\n                            \n                            return (  \n                                <PostListItem item={item}  \n                                                comments_number={comments_number} \n                                                like_number={likes_number}\n                                                id={item._id} \n                                                index={index}/>       \n                            )\n                        })\n                    }\n                  </div>\n                </React.Fragment>\n                }\n            </div> \n            \n            \n        )\n    }\n\n\n\n}\n\nexport default PostList"]},"metadata":{},"sourceType":"module"}