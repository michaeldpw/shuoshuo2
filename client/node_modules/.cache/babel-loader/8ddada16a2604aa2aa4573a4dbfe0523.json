{"ast":null,"code":"var _jsxFileName = \"/Users/peiwendu/Desktop/shuoshuo2.0/client/src/components/PostList.js\";\nimport React from 'react';\nimport axios from 'axios';\nimport './components.css';\nimport Img from './Img';\n\nclass PostList extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      post: [],\n      total: 0,\n      currentPage: 1\n    };\n\n    this.getCount = () => {\n      axios.get('/count').then(res => {\n        this.setState({\n          total: res.data.count\n        });\n      });\n    };\n\n    this.getData = async page => {\n      const response = await fetch(\"/allpost?page=\".concat(page), {\n        method: 'GET',\n        headers: {\n          'Accept': 'application/json',\n          'Content-Type': 'application/json'\n        }\n      });\n      const data = await response.json();\n      this.setState({\n        post: data.result,\n        currentPage: data.page + 1\n      });\n    };\n\n    this.handlePrevious = () => {\n      if (this.state.currentPage !== 1) {\n        this.getData(this.state.currentPage - 1 - 1);\n        console.log(\"previous\");\n      }\n    };\n\n    this.handleNext = () => {\n      var total_page = Math.ceil(this.state.total / 5);\n      console.log(this.state.currentPage + 1);\n\n      if (this.state.currentPage < total_page) {\n        this.getData(this.state.currentPage);\n        console.log(\"next\");\n      }\n    };\n  }\n\n  componentDidMount() {\n    this.getCount();\n    this.getData(0); //0是后端的第一页\n  }\n\n  render() {\n    const pageNumber = [];\n\n    if (this.state.total !== 0) {\n      for (let i = 1; i <= Math.ceil(this.state.total / 5); i++) {\n        pageNumber.push(i);\n      }\n    }\n\n    return React.createElement(\"div\", {\n      className: \"container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71\n      },\n      __self: this\n    }, React.createElement(\"nav\", {\n      \"aria-label\": \"Page navigation\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72\n      },\n      __self: this\n    }, React.createElement(\"ul\", {\n      className: \"pagination\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73\n      },\n      __self: this\n    }, React.createElement(\"li\", {\n      onClick: this.handlePrevious,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74\n      },\n      __self: this\n    }, React.createElement(\"a\", {\n      \"aria-label\": \"Previous\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      \"aria-hidden\": \"true\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76\n      },\n      __self: this\n    }, \"\\xAB\"))), pageNumber.map((item, index) => {\n      let classes = this.state.currentPage === item ? \"active\" : '';\n      return React.createElement(\"li\", {\n        key: index,\n        className: classes,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 82\n        },\n        __self: this\n      }, React.createElement(\"a\", {\n        onClick: () => this.getData(item - 1),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 83\n        },\n        __self: this\n      }, item));\n    }), React.createElement(\"li\", {\n      onClick: this.handleNext,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92\n      },\n      __self: this\n    }, React.createElement(\"a\", {\n      \"aria-label\": \"Next\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      \"aria-hidden\": \"true\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94\n      },\n      __self: this\n    }, \"\\xBB\"))))), React.createElement(\"div\", {\n      className: \"list-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    }, this.state.post.map((item, index) => {\n      return React.createElement(\"a\", {\n        className: \"list-group-item\",\n        key: index,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"comment-avatar\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104\n        },\n        __self: this\n      }, React.createElement(Img, {\n        src: \"/avatar/\" + item.username + '.jpg',\n        alt: \"\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"username\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107\n        },\n        __self: this\n      }, React.createElement(\"h4\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108\n        },\n        __self: this\n      }, item.username), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109\n        },\n        __self: this\n      }, item.datetime)), React.createElement(\"div\", {\n        className: \"content\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112\n        },\n        __self: this\n      }, item.content)));\n    })));\n  }\n\n}\n\nexport default PostList;","map":{"version":3,"sources":["/Users/peiwendu/Desktop/shuoshuo2.0/client/src/components/PostList.js"],"names":["React","axios","Img","PostList","Component","state","post","total","currentPage","getCount","get","then","res","setState","data","count","getData","page","response","fetch","method","headers","json","result","handlePrevious","console","log","handleNext","total_page","Math","ceil","componentDidMount","render","pageNumber","i","push","map","item","index","classes","username","datetime","content"],"mappings":"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","sourcesContent":["import React from 'react'\nimport axios from 'axios';\nimport './components.css';\nimport Img from './Img';\n\nclass PostList extends React.Component{\n\n    state = {\n        post: [],\n        total: 0,\n        currentPage: 1\n    }\n\n    getCount = () => {\n        axios.get('/count').then(res => {\n            this.setState({\n                total: res.data.count\n            })\n        })\n    }\n\n    getData = async (page) => {\n        const response = await fetch(`/allpost?page=${page}`, {\n            method: 'GET',\n            headers: {\n              'Accept': 'application/json',\n              'Content-Type': 'application/json',\n            },\n          });\n      \n          const data = await response.json();\n      \n          this.setState({\n            post: data.result,\n            currentPage: data.page + 1\n          });\n    }\n\n    componentDidMount(){\n        this.getCount();\n        this.getData(0); //0是后端的第一页\n    }\n\n    handlePrevious = () => {\n\n        if(this.state.currentPage !== 1){\n            this.getData(this.state.currentPage - 1 - 1);\n            console.log(\"previous\");\n        }\n    }\n\n    handleNext = () => {\n        var total_page = Math.ceil(this.state.total/5);\n        console.log(this.state.currentPage + 1 );\n        if(this.state.currentPage < total_page){\n            this.getData(this.state.currentPage);\n            console.log(\"next\");\n        }\n    }\n\n    render(){\n\n        const pageNumber = [];\n        if(this.state.total !== 0){\n            for(let i = 1; i <= Math.ceil(this.state.total/5); i++){\n                pageNumber.push(i);\n            }\n        }\n\n        return (\n            <div className=\"container\">\n               <nav aria-label=\"Page navigation\">\n                    <ul className=\"pagination\">\n                        <li onClick={this.handlePrevious}>\n                            <a aria-label=\"Previous\">\n                                <span aria-hidden=\"true\" >&laquo;</span>\n                            </a>\n                        </li>\n                            {\n                               pageNumber.map((item, index) => {\n                                let classes = (this.state.currentPage) === item ? \"active\" : '';\n                                        return <li key={index} className={classes}>\n                                                    <a \n                                                       onClick={() => this.getData(item - 1)}    \n                                                    >\n                                                       {item}\n                                                    </a>\n\n                                                </li>                         \n                               })\n                            }\n                        <li onClick={this.handleNext}>\n                            <a  aria-label=\"Next\" >\n                                <span aria-hidden=\"true\">&raquo;</span>\n                            </a>\n                        </li>\n                    </ul>\n                </nav>\n               <div className=\"list-group\">\n                    {\n                        this.state.post.map((item, index) => {\n                            return (\n                                 <a className=\"list-group-item\" key={index}>\n                                    <div className=\"comment-avatar\">\n                                           <Img src={\"/avatar/\" + item.username + '.jpg'} alt=\"\"/>\n                                    </div>\n                                    <div className=\"username\">\n                                        <h4>{item.username}</h4> \n                                        <p>{item.datetime}</p>\n                                    </div>\n                                    <div className=\"content\">\n                                        <p>{item.content}</p>\n                                    </div>\n                                   \n                                   \n                                </a>\n                            )\n                        })\n                    }\n                </div>\n            </div> \n            \n        )\n    }\n\n\n\n}\n\nexport default PostList"]},"metadata":{},"sourceType":"module"}